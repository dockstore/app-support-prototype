# .dockstore.yml for Xena
# https://github.com/Ldcabansay/xenahub
version: 1.1
service:
  subclass: docker-compose
  name: UCSC Xena Browser
  author: UCSC Genomics Institute
  description: |
    The UCSC Xena browser is an exploration tool for public and private,
    multi-omic and clinical/phenotype data.
  files:
     - docker-compose.yml 
         primary: true # Whether this is the primary descriptor, not always applicable
     - README.md
  parameters:
    - HTTP_PORT:
        type: environment
        default: 7222
        description: The container's HTTP port
    - HTTPS_PORT:
        type: environment
        default: 7223
        description: The container's HTTPS port
  data:
    - predefined:
      - clinical:
          required: false
          description: |
            Treehouse Public Expression Dataset v9 (March 2019).
            Treehouse RNASeq gene expression data.
            Values in this dataset use HUGO gene names and are transformed by log2(x +1) of the TPM value.
            This data was generated by the ribodepletion library preparation method.
            Note that this is a poor example; you wouldn't point to public data like this but instead private data
          target:
            directory: xena/files
            source:
              - https://xena.treehouse.gi.ucsc.edu/download/TreehousePEDv9_Ribodeplete_clinical_metadata.2019-03-25.tsv
              - https://xena.treehouse.gi.ucsc.edu/download/TreehousePEDv9_Ribodeplete_clinical_metadata.2019-03-25.tsv.json
            postUp:
              commands: 
                - docker exec xena java -jar /ucsc_xena/cavm-0.24.0-standalone.jar --load /root/xena/files/TreehousePEDv9_Ribodeplete_clinical_metadata.2019-03-25.tsv
    - probemap:
        description: |
          Comprehensive annotation, gene only
          Gene: GENCODE 23 comprehensive (hg38) e.g. ENSG00000223972.5
          Not required, but recommended
        target:
          directory: xena/files
          source:
            - https://xena.treehouse.gi.ucsc.edu/download/gencode.v23.annotation.gene.probemap.tsv
            - https://xena.treehouse.gi.ucsc.edu/download/gencode.v23.annotation.gene.probemap.json
          postUp: 
              commands: 
                - docker exec xena java -jar /ucsc_xena/cavm-0.24.0-standalone.jar --load /root/xena/files/gencode.v23.annotation.gene.probemap.tsv
    - user-specified:
      required: false
      multiple: true # Whether the user can specify multiple files or not
      description: |
        The user can optionally specify data to be loaded into the local Xena instance
      target:
        directory: xena/files
        source:
          data_one: 
            description: The url of a TSV file
          data_two:
            description: The url of the TSV file's corresponding JSON file
        postUp:
            commands: 
              - docker exec xena java -jar /ucsc_xena/cavm-0.24.0-standalone.jar --load /root/xena/files/${data_one}
    
#  examples:
#    - clinical:
#        description: |
#          Treehouse Public Expression Dataset v9 (March 2019).
#          Treehouse RNASeq gene expression data.
#          Values in this dataset use HUGO gene names and are transformed by log2(x +1) of the TPM value.
#          This data was generated by the ribodepletion library preparation method.
#        target:
#          directory: xena/files
#          source:
#            - https://xena.treehouse.gi.ucsc.edu/download/TreehousePEDv9_Ribodeplete_clinical_metadata.2019-03-25.tsv
#            - https://xena.treehouse.gi.ucsc.edu/download/TreehousePEDv9_Ribodeplete_clinical_metadata.2019-03-25.tsv.json
#          afterRunning: |
#            make load file=TreehousePEDv9_Ribodeplete_clinical_metadata.2019-03-25.tsv
#    - expected:
#        description: |
#          Treehouse Public Expression Dataset v9 (March 2019).
#          Treehouse RNASeq gene expression data.
#          Values in this dataset are expected_count and use Ensembl gene identifiers.
#          This data was generated by the ribodepletion library preparation method.
#        target:
#          directory: xena/files
#          source:
#              - https://xena.treehouse.gi.ucsc.edu/download/TreehousePEDv9_Ribodeplete_unique_ensembl_expected_count.2019-03-25.tsv
#              - https://xena.treehouse.gi.ucsc.edu/download/TreehousePEDv9_Ribodeplete_unique_ensembl_expected_count.2019-03-25.tsv.json
#          afterRunning: |
#              make load file=TreehousePEDv9_Ribodeplete_unique_ensembl_expected_count.tsv
#    - probemap:
#        description: |
#          Comprehensive annotation, gene only
#          Gene: GENCODE 23 comprehensive (hg38) e.g. ENSG00000223972.5
#        target:
#          directory: xena/files
#          source:
#            - https://xena.treehouse.gi.ucsc.edu/download/gencode.v23.annotation.gene.probemap.tsv
#            - https://xena.treehouse.gi.ucsc.edu/download/gencode.v23.annotation.gene.probemap.json
#          afterRunning: |
#              make load file=gencode.v23.annotation.gene.probemap.tsv
#  user-specified-scenario:
#    target:
#        directory: xena/files
#        source:
#          - TSV
#          - JSON
#        afterRunning: |
#          make load file=$TSV
